---
category: Stuff
path: '/stuff/:id'
title: 'server'
type: 'TIPS'

layout: nil
---

### link server

1. 首先登录跳板机172.16.101.136

2. 然后从跳板机访问172.16.0.248

### 端口转发：

１．ssh -N -f -L 2222:172.16.0.248:22 lidd@172.16.101.136

２．ssh lidd@localhost -p 2222

### sshfs mount

#### mount

`sshfs lidd@localhost:/home/lidd /home/dd/remote -p 2222`

#### unmount

`fusermount -u /home/dd/remote` or `umount /home/dd/remote`

#### auto mount on start up

add 

`sshfs#lidd@localhost:/home/lidd /home/dd/remote -p 2222 fuse defaults,auto,allow_other 0 0`

 to file '/etc/fstab'

### To connect network

1. ``sudo vim /etc/resolvconf/resolv.conf.d/base``
2. add 'nameserver 8.8.8.8' to file
3. ``resolvconf -u``

### Transparent Multi-hop SSH

- your computer: dd
- your jump machine: jumper
- remote server: g-server

1. `subl ~/.ssh/config`

2. add following to it 

   > Host jumper
   > ​	user lidd
   > ​	HostName 172.16.101.136
   >
   > Host g-server
   > ​	user lidd
   >   	ProxyCommand ssh -q jumper nc -q0 172.16.0.248 22

   Then you can direct use 

   ```bash
   ssh g-server
   ssh -X g-server
   scp path/to/local/file g-server:path/to/remote/file
   ```

3. improve speed 

   * mkdir ~/.ssh/tmpmkdir ~/.ssh/tmp

   * add these two lines **at the start** of your `~/.ssh/config` (make sure to use your username in place of '*YOUR-NAME*'):

   > ControlMaster auto
   > ControlPath   /home/YOUR-NAME/.ssh/tmp/%h_%p_%r

### ssh key setting

​	You run the first command once to set up your public/private key pair and then you run the second command once for each host you want to connect to.

```bash
ssh-keygen
ssh-copy-id hostname
```

ref. [SSHMenu Articles](http://sshmenu.sourceforge.net/articles/)



